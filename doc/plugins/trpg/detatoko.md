Trpg::Detatoko
==============

ゲーム専用プラグイン第1弾、「でたとこサーガ」用プラグイン。
でたとこサーガ公式サイト: http://detatoko-saga.com/

コマンド
--------

### スキルランクから判定値を算出

#### 書式

```
.ds<SR>
.ds<SR>[+-*/]<固定値>
.ds<SR>[+-*/]<固定値>@<フラグ>
.ds<SR>@<フラグ>
。です<●>
```

#### 説明

`<SR>` にスキルランクを入れると、ダイスを振って判定値を求めます。  
追加で一つだけ、固定値で四則演算をすることができます。割り算で小数が出る場合は、「絶対のルール(ルールブックp.22)」に従い切り上げます。  
`@` の直後に現在のフラグを入れることで、(固定値で四則演算をする前の)判定値がフラグ以下だった場合はそれを通知し、気力ダメージを求めます。

[DiceRoll](../dice_roll.md) と同じく、日本語のダイスコマンドが実装されています。こちらは、スキルランクが _●_ の時の判定値を求めます。●にはあ段のひらがな「あかさたなはまやらわ」が、それぞれ数字「1234567890」に相当しています。

![ひらがなと数字の対応](../images/dice-roll-ja.png "ひらがなと数字の対応")

#### 例

```
.ds3
> でたとこサーガ [koi-chan]<判定値>: スキルレベル = 3 -> [2, 5, 3, 2]:8 = 8
.ds3+3
> でたとこサーガ [koi-chan]<判定値>: スキルレベル = 3 -> [3, 5, 6, 6]:12 + 3 = 15
.ds3+3@10
> でたとこサーガ [koi-chan]: スキルランク = 3 -> [6, 6, 5, 6]:12 + 3 = 15 (フラグ:10)
.ds3@10
> でたとこサーガ [koi-chan]: スキルランク = 3 -> [5, 4, 5, 5]:10 = 10 (フラグ:10)
> でたとこサーガ [koi-chan]: 【フラグ以下】気力ダメージ -> 1d6 = 4
。ですか
> でたとこサーガ [koi-chan]: スキルランク = 2 -> [4,3,4:8] = 8
```

### 体力烙印の獲得

#### 書式

```
.dvst
.dsst
.dtr
。で体力烙印
```

#### 説明

体力烙印を獲得します。例の3コマンドのどれも同じように動作します。
最初に1ゾロが出た時の振り足しなどにも対応しています。

#### 例

```
.dvst
> でたとこサーガ [koi-chan]<体力烙印>: [5,2:7] -> 7:【衝撃】
.dtr
> 。で体力烙印
```

### 気力烙印の獲得

#### 書式

```
.dmst
.dwst
.dkr
。で気力烙印
```

#### 説明

上と同様に気力烙印を獲得します。

#### 例

```
.dmst
> でたとこサーガ [koi-chan]<気力烙印>: [3,2:5] -> 5:【後悔】
.dkr
> 。で気力烙印
```

### 体力バッドエンド

#### 書式

```
.dvbet
.dsbet
.dtb
。で体力バッドエンド
```

#### 説明

体力バッドエンド表を振ります。

#### 例

```
.dvbet
> でたとこサーガ [koi-chan]<体力バッドエンド>: [2,4:6] -> 6:【暴走】
.dtb
> 。で体力バッドエンド
```

### 気力バッドエンド

#### 書式

```
.dmbet
.dwbet
.dkb
。で気力バッドエンド
```

#### 説明

気力バッドエンド表を振ります。

#### 例

```
.dmbet
> でたとこサーガ [koi-chan]<気力バッドエンド>: [6,5:11] -> 11:【気絶】
.dkb
> 。で気力バッドエンド
```

### スタンス表

#### 書式

```
.dstance <系統>
。でスタンス <系統>
```

#### 説明

スタンス表を、指定したスタンス系統から1つ振ります。指定しないと振ることができません。  
スタンス系統に「全部」を指定する事もできます。

スタンス系統の区切りは、「+」「＋」「・」の3種類に対応しています。

#### 例

```
.dstance 敵視・宿命・憎悪
> でたとこサーガ [koi-chan]<スタンス表>: 候補:[敵視,宿命,憎悪] -> 系統:【憎悪】 5:【裏切り】
。でスタンス　全部
> でたとこサーガ [koi-chan]<スタンス表>: 候補:[敵視,宿命,憎悪,雲上,従属,不明] -> 系統:【従属】 1:【隷従】
```

### ラスボス立場表

#### 書式

```
.dlbg
。でラスボス立場
```

#### 説明

ラスボス立場表を振ります。例の3コマンドのどれも同じように動作します。

サプリメント『でたとこフロンティア』にて「ポジション」ルールが導入されたため、RGRBv0.9.0 までの _.dlbp_ コマンドは名前が変更されました。  

#### 例

```
.dlbg
> でたとこサーガ [koi-chan]<ラスボス立場>: [5,1:6] -> 6: 【侵略】
。でラスボス立場
> でたとこサーガ [koi-chan]<ラスボス立場>: [1,1:2] -> 2: 【恐怖】
```

### 敵へのラスボス立場表

#### 書式

```
.ddg
。で敵へのラスボス立場
```

#### 説明

サプリメント『でたとこダークネス』で追加された、「敵へのラスボス立場表」を振ります。

#### 例

```
.ddg
> でたとこサーガ [koi-chan]<敵へのラスボス立場>: [3,3:6] -> 6: 【有象無象】
。で敵へのラスボス立場
> でたとこサーガ [koi-chan]<敵へのラスボス立場>: [1,3:4] -> 4: 【悪の同輩】
```

### クラス選択

#### 書式

```
.dc
。でクラス
```

#### 説明

クラスを選択します。  
基本ルールブックに掲載された12種のほか、サプリメント『でたとこフロンティア』『でたとこダークネス』で追加された各3種のクラスも加えた全18種のクラスから1つをランダムに出力します。

#### 例

```
.dc
> でたとこサーガ [koi-chan]<クラス>: 05 -> 戦士
。でクラス
> でたとこサーガ [koi-chan]<クラス>: 15 -> 占い師
```

### PC 用ポジション選択

#### 書式

```
.dpp
。でポジション
```

#### 説明

サプリメント『でたとこフロンティア』で追加されたルールです。  
PC 用のポジションをランダムに1つ出力します。

#### 例

```
.dpp
> でたとこサーガ [koi-chan]<PCポジション>: 凡人
。でポジション
> でたとこサーガ [koi-chan]<PCポジション>: カリスマ
```

### NPC 用ポジション選択

#### 書式

```
.dnpp
。で敵ポジション
```

#### 説明

上記の「PC 用ポジション選択」と同様に、こちらは敵 NPC 用のポジションをランダムに1つ出力します。
サプリメント『でたとこダークネス』で追加されたものも出力されます。導入していない場合は振り直してください。

#### 例

```
.dnpp
> でたとこサーガ [koi-chan]<敵NPCポジション>: 黒幕
。で敵ポジション
> でたとこサーガ [koi-chan]<敵NPCポジション>: 侵略者
```

### 悪のポジション

#### 書式

```
.ddpp
。で悪ポジション
```

#### 説明

サプリメント『でたとこダークネス』で追加されたルールです。
悪のポジションをランダムに1つ出力します。

#### 例

```
.ddpp
> でたとこサーガ [koi-chan]<悪のポジション>: 野獣
。で悪ポジション
> でたとこサーガ [koi-chan]<悪のポジション>: 狂的天才
```

### 1行キャラクターシート

#### 書式

```
.dcs <ID>
```

#### 説明

表形式の1キャラクター1行で表されたキャラクターシートを出力します。  
「メモ帳」などのテキストエディタにコピペして使うと、簡易的なステータス管理ができるようになります。

月光華亭さんで、SW2用に用意されている「技能表」に触発されて作った [でたとこサーガ 1行キャラクターシート出力](http://d1lcs.kazagakure.net/) の中核をライブラリ化し、IRC から直接出力できるようにしました。  
出力されるものは上記サイトとほぼ同様のものです。

『でたとこサーガ』公式の [でたとこサーガ「キャラクターシート登録書」](http://detatoko-saga.com/character/) に登録されたデータを表に加工します。  
出力したいキャラクター登録書の URL の最後の数字を指定します。  
例えばサンプルキャラクターの「王道勇者」なら、URL は http://detatoko-saga.com/character/1 なので、1 を指定するわけです。

また ID と同様に title と入れると、タイトル行も出力されるようになります。

出力されるデータについて、詳しくは [出力データ解説](d1lcs.md)をご覧ください。

#### 例

```
.dcs 1
> 王道勇者    |１|11/11 10/10 0|勇者戦士|聖希折鉄強必|１１　４　　|   1|でたとこサーガ
.dcs title 1 2
> 名前        |Lv|体力　気力 旗|クラス　|スキル　　　|意感交肉技知|ID  |プレイヤー
> 王道勇者    |１|11/11 10/10 0|勇者戦士|聖希折鉄強必|１１　４　　|   1|でたとこサーガ
> 暗黒魔王    |１|10/10 11/11 0|魔王暗黒|無圧極ド暗愉|３１１　　１|   2|でたとこサーガ
.dcs 1 1000 title
> [koi-chan]<1行キャラクターシート>: 1 件のエラーが発生しました
> [koi-chan]<1行キャラクターシート>: キャラクターシートID '1000' は存在しません
> 名前        |Lv|体力　気力 旗|クラス　|スキル　　　|意感交肉技知|ID  |プレイヤー
> 王道勇者    |１|11/11 10/10 0|勇者戦士|聖希折鉄強必|１１　４　　|   1|でたとこサーガ
```
